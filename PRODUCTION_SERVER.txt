=============================================================
  IOBroker Dashboard - Production Server Management Guide
=============================================================

This guide explains how to manage the production server for the
Iobroker Dashboard application.

=============================================================
1. QUICK RESTART (No Code Changes)
=============================================================

If you just need to restart the server without rebuilding:

    pkill -f "serve -s dist" && nohup serve -s dist -l 5173 > /tmp/serve.log 2>&1 &

This command:
  - Kills any running serve process
  - Starts a new server in the background
  - Serves files from the 'dist' directory
  - Runs on port 5173
  - Logs output to /tmp/serve.log

=============================================================
2. FULL REBUILD AND RESTART (After Code Changes)
=============================================================

When you've made changes to the code (TypeScript, React components,
or configuration files):

Step 1: Navigate to project directory
    cd /home/claude/Desktop/ClaudeCode_test/iobroker-dashboard

Step 2: Build the production version
    npm run build

Step 3: Stop the old server and start the new one
    pkill -f "serve -s dist" && nohup serve -s dist -l 5173 > /tmp/serve.log 2>&1 &

OR do it all in one command:
    cd /home/claude/Desktop/ClaudeCode_test/iobroker-dashboard && npm run build && pkill -f "serve -s dist" && nohup serve -s dist -l 5173 > /tmp/serve.log 2>&1 &

=============================================================
3. CHECK IF SERVER IS RUNNING
=============================================================

To see if the server is currently running:

    ps aux | grep "serve -s dist" | grep -v grep

If running, you'll see output like:
    claude    135456  0.0  2.7 1209880 94660 ?  Sl  11:49  0:00 node .../serve -s dist -l 5173

If not running, you'll see no output.

=============================================================
4. VIEW SERVER LOGS
=============================================================

To see the server logs:

    cat /tmp/serve.log

To watch logs in real-time (press Ctrl+C to stop):

    tail -f /tmp/serve.log

=============================================================
5. ACCESS THE DASHBOARD
=============================================================

Once the server is running, access the dashboard at:

    http://localhost:5173

=============================================================
6. STOP THE SERVER
=============================================================

To stop the production server:

    pkill -f "serve -s dist"

=============================================================
7. TROUBLESHOOTING
=============================================================

Problem: Server won't start or port is already in use
Solution: Kill any existing serve processes first
    pkill -f "serve -s dist"
    pkill -f "vite"  # Also kill dev servers

Then check what's using port 5173:
    ss -tlnp | grep 5173

Problem: Changes not appearing in browser
Solution:
    1. Rebuild: npm run build
    2. Restart server (see section 1)
    3. Hard refresh browser (Ctrl+Shift+R or Cmd+Shift+R)
    4. Clear browser cache

Problem: Build fails
Solution:
    1. Check for TypeScript errors: npm run build
    2. Check for missing dependencies: npm install
    3. Review error messages in the build output

Problem: Server logs show errors
Solution:
    1. Check logs: cat /tmp/serve.log
    2. Verify dist/ directory exists and has files
    3. Ensure port 5173 is not blocked by firewall

=============================================================
8. DEVELOPMENT SERVER (Alternative)
=============================================================

For development with hot-reload (changes appear automatically):

    cd /home/claude/Desktop/ClaudeCode_test/iobroker-dashboard
    npm run dev

This starts the Vite dev server (usually on http://localhost:5173)

To stop: Press Ctrl+C in the terminal where it's running

Note: Dev server is for development only. Use production server
for actual deployment.

=============================================================
9. PROJECT STRUCTURE
=============================================================

Key directories:
  - src/          : Source code (React components, TypeScript)
  - dist/         : Built production files (generated by npm run build)
  - ToAdd/        : Contains todo.json configuration file
  - node_modules/ : Dependencies (do not modify)

=============================================================
10. COMMON TASKS
=============================================================

Update todo.json configuration:
    1. Edit: /home/claude/Desktop/ClaudeCode_test/ToAdd/todo.json
    2. No rebuild needed - changes load on page refresh
    3. Hard refresh browser (Ctrl+Shift+R)

Update React components or TypeScript code:
    1. Edit files in src/ directory
    2. Rebuild: npm run build
    3. Restart server (see section 2)
    4. Refresh browser

Update dependencies:
    1. Edit: package.json
    2. Install: npm install
    3. Rebuild: npm run build
    4. Restart server

=============================================================
11. EMERGENCY RESET
=============================================================

If everything is broken and you need to start fresh:

    cd /home/claude/Desktop/ClaudeCode_test/iobroker-dashboard
    pkill -f "serve"
    pkill -f "vite"
    rm -rf node_modules
    rm -rf dist
    npm install
    npm run build
    nohup serve -s dist -l 5173 > /tmp/serve.log 2>&1 &

Warning: This removes all dependencies and rebuilds from scratch.
Only use if absolutely necessary.

=============================================================
END OF GUIDE
=============================================================

For more help, see:
  - Project README: README.md
  - Vite documentation: https://vitejs.dev/
  - React documentation: https://react.dev/
